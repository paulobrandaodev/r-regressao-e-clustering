---
title: "Trabalho Final"
author: "Paulo Brandão/Gabriel Victor"
date: '2022-06-27'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Set Local
```{r setlocal}
setwd('C:/Users/paulo/Downloads/r-regressao-e-clustering')
getwd()
```

## Use Libs
```{r uselibs, message=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
```

## Análise exploratória

Importamos os dados

```{r vendasonline, message=FALSE}
vendas <- readr::read_csv2('online_retail_II.csv')
```

Vemos uma amostra das informaçoes disponíveis

```{r vendasonlineview}
head(vendas)
```

Removemos os NA's e convertemos a coluna *Customer ID* para char

```{r vendas_parse, message=FALSE}
vendas_sem_na = na.omit(vendas) %>% 
  mutate(`Customer ID` = as.character(`Customer ID`)) %>% 
  rename(., `CustomerID` = `Customer ID`)
head(vendas_sem_na)
```

> Random Forest

Adicionamos a biblioteca

```{r random_forest_lib_add}
  library(randomForest)
  require(caTools)
  
  library(rpart)
  library(rpart.plot)
```

Geramos o cálculo de entropia:
```{r entropia}
  dados <- vendas_sem_na

  set.seed(1234)
  index  <- sample.int(nrow(dados), 0.8 * nrow(dados))
  treino <- dados[index,]
  teste  <- dados[-index,]
  vendas_sem_na %>% names()
  
  mod1 <- rpart(Quantity ~ Price + Description + Country, data = treino)
  mod2 <- rpart(Quantity ~., data = treino)
  
  rpart.plot(mod1)
```


```{r random_forest_generate_2}

data <- vendas_sem_na

sample = sample.split(data$Quantity, SplitRatio = .75)
train = subset(data, sample == TRUE)
test  = subset(data, sample == FALSE)

dim(train)
dim(test)
```

Inicializamos a classe RandomForest

```{r random_forest_initialize}
  model1 <- randomForest(Quantity ~ ., data = train, importance = TRUE, ntree = 10)
```




## Clusterização
